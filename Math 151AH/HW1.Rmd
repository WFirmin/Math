---
title: "HW1"
author: "Will Firmin"
output: html_notebook
---

```{python}
import math
import matplotlib.pyplot as plt
```


# Problem 1
### a)
```{python}
print("Calculated:\n",1 - math.cos(10**-3))
print("True:\n","4.9999995833333472222219742063519620811078710385413014376488... Ã—10^-7")
```

Accurate to 10 digits.

### b)
Identity: $1-\cos(\theta)=2\sin^2(\frac{\theta}2)$

### c)
```{python}
print(2*math.sin(10**-3 / 2)**2)
```
Accurate to all 16 digits; this is much better than before.

# Problem 2
### b)
```{python}
fun = lambda x: math.sin(math.pi / 2 + x)

d = 0.1
lowest_not = 1
highest_is = 0
for i in range(1000):
  if fun(d) == 1:
    highest_is = d
  else:
    lowest_not = d
  d = (highest_is + lowest_not)/2

print(d)
```

# Problem 8)
```{python}
x0 = 0.75
f = lambda x: (math.e**x / 3)**0.5
x = [x0]
for i in range(6):
  x.append(f(x[-1]))

aitken = lambda i: x[i] - (x[i+1] - x[i])**2 / (x[i+2] - 2*x[i+1] + x[i])
x2 = [aitken(i) for i in range(5)]
for a in x2:
  print(a)

```

# Problem 9)
```{python}
def FPI(f, x0, alpha, N=100):
  # need to figure out alpha
  g = lambda x: x - alpha*f(x)
  x = x[0]
  for i in range(N):
    x.append(g(x[-1]))
  return x

def Newton(f, df, x0, N=100):
  x = [x0]
  for i in range(N):
    x.append(x[-1] - f(x[-1]) / df(x[-1]))
  return x

def secant(f, x0, N=100):
  x = [x0, f(x0)]
  for i in range(N):
    try:
      x.append(x[-1] - f(x[-1])*(x[-1]-x[-2]) / (f(x[-1]) - f(x[-2])))
    except ZeroDivisionError: pass
  return x

# def steffensen(f, x0, N=100):
#   x = x0
#   for i in range(N):
#     try:
#       xi0 = x
#       xi1 = f(x)
#       xi2 = f(xi1)
#       #print(i,"\n",x,"\n",xi1,"\n",xi2)
#       x = xi0 - (xi1 - xi0)**2 / (xi2 - 2*xi1 + x)
#     except ZeroDivisionError: pass
#   return x

def steffensen(f, x0, N=100):
  x = [x0]
  for i in range(N):
    try:
      x.append(x[-1] - f(x[-1])**2 / (f(x[-1] + f(x[-1])) - f(x[-1])))
    except ZeroDivisionError: pass
  return x

```

### a)
```{python}
F = lambda x: 10*x**2 - 4*x - 5
#secant:
sec = secant(F,-1)
#steffensen:
stef = steffensen(F,-1)
L = lambda X: list(range(len(X)))

plt.plot(L(sec),sec)
plt.legend()
plt.show
```
### b)
```{python}
F = lambda x: x**4 - x**3 - 3*x**2 + 5*x - 2

#secant:
print(secant(F,1.3))

#steffensen:
print(steffensen(F,1.3))
```

### c)
```{python}
F = lambda x: math.sin(x) - math.log(x)

#secant:
print(secant(F,2))

#steffensen:
print(steffensen(F,2))
```

